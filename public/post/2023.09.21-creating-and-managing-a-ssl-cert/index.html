<!DOCTYPE html>
<html lang="en" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'>
<link rel="icon" type="image/x-icon" href="/img/favicon.gif"><meta name='description' content='Heres my cheat sheet on creating and managing a ssl cert on ubuntu :)'>
<meta name="keywords" content="unorthodoxdev"><title>Creating and Managing a SSL Cert</title>

<link rel='canonical' href='https://unorthodoxdev.net/post/2023.09.21-creating-and-managing-a-ssl-cert/'>

<link rel="stylesheet" href="/scss/style.min.ff300df33b80e2ac49809c825614392ed1c7b27591d65d3c4043602cd162e25f.css"><meta property='og:title' content='Creating and Managing a SSL Cert'>
<meta property='og:description' content='Heres my cheat sheet on creating and managing a ssl cert on ubuntu :)'>
<meta property='og:url' content='https://unorthodoxdev.net/post/2023.09.21-creating-and-managing-a-ssl-cert/'>
<meta property='og:site_name' content='Unorthodoxdev'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:published_time' content='2023-09-21T16:39:17-04:00'/><meta property='article:modified_time' content='2023-09-21T16:39:17-04:00'/>
<meta name="twitter:title" content="Creating and Managing a SSL Cert">
<meta name="twitter:description" content="Heres my cheat sheet on creating and managing a ssl cert on ubuntu :)">
    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column compact"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    <img src="https://avatars.githubusercontent.com/u/117940901?s=400&amp;u=4194e396b8bc6a5b29d08876b4598d1f9eb4a02f&amp;v=4" width="300" height="300" class="site-logo" loading="lazy" alt="Avatar">
                
                </a>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">Unorthodoxdev</a></h1>
            <h2 class="site-description"></h2>
        </div>
    </header><ol class="social-menu">
            
                <li>
                    <a 
                        href='https://github.com/ofgrenudo'
                        target="_blank"
                        title="github"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                <span>Home</span>
            </a>
        </li>
        
        
        <li >
            <a href='/about/' >
                
                
                
                <span>About me</span>
            </a>
        </li>
        
        
        <li >
            <a href='/comment/' >
                
                
                
                <span>Comment</span>
            </a>
        </li>
        
        
        <li >
            <a href='/recipes/' >
                
                
                
                <span>Recipes</span>
            </a>
        </li>
        
        
        <li >
            <a href='/page/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        

        <div class="menu-bottom-section">
            
            
                <li id="dark-mode-toggle">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <span>Dark Mode</span>
                </li>
            
        </div>
    </ol>
</aside>

    

            <main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/post/2023.09.21-creating-and-managing-a-ssl-cert/">Creating and Managing a SSL Cert</a>
        </h2>
    
        
        <h3 class="article-subtitle">
            Heres my cheat sheet on creating and managing a ssl cert on ubuntu :)
        </h3>
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Sep 21, 2023</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    4 minute read
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <p>This guide is intended for Ubuntu 22.04 and is intended for use with a Apache2 web server. To get started we need to make sure you have Apache2 installed, we can use grep to check. These instructions were written on a Ubuntu Server.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>apt list --installed | grep <span style="color:#e6db74">&#34;apache2&#34;</span>
</span></span></code></pre></div><p>Next will need to allow Apache through the firewall on both http (80) and https (443). We can do so with the below command</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo ufw allow <span style="color:#e6db74">&#34;Apache Full&#34;</span>
</span></span></code></pre></div><p>Next we will need to enable the Apache <code>mod_ssl</code> module. The Apache <code>mod_ssl</code> module will allow Apache to support SSL encryption. The command to do so is below.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo a2enmod ssl
</span></span><span style="display:flex;"><span>sudo systemctl restart apache2
</span></span></code></pre></div><p>Now, Apache is configured and ready for encryption. We can move onto generating a TLS certificate. To do so we will need to do the following below command</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo openssl req -x509 -nodes -days <span style="color:#ae81ff">365</span> -newkey rsa:2048 -keyout /etc/ssl/private/apache-selfsigned.key -out /etc/ssl/certs/apache-selfsigned.crt
</span></span></code></pre></div><p>Running the above command will prompt you to enter a bunch of information. Please follow through each of the steps and answer them completely. The following flags on the above command do as listed below</p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>Flag</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>req -x509</code></td>
<td>This specifies that we want to use the X.509 certificate signing request managment. X.509 is a public key infrastructure standard that TLS adhears too.</td>
</tr>
<tr>
<td><code>-nodes</code></td>
<td>Nodes tells OpenSSL to skip the option to secure our certificate with a passphrase because we want apache to be able to read the file. A passphrase would prevent apache from being able to do so.</td>
</tr>
<tr>
<td><code>-days 365</code></td>
<td>This option sets the length of time that the certificate will be considered valid. Here we have set it for one year. Browsers will reject just about any certificate that is valid for longer than a year.</td>
</tr>
<tr>
<td><code>-newkey rsa:2048</code></td>
<td>This tells the program we want to generate a new certificate and key at the same time. the rsa:2048 makes it a RSA key that is 2048 bits long.</td>
</tr>
<tr>
<td><code>-keyout</code></td>
<td>This line tells the program where to place the private key file.</td>
</tr>
<tr>
<td><code>-out</code></td>
<td>This line tells the program where to place the certificate that we are creating.</td>
</tr>
</tbody>
</table></div>
<p>As a general note, certificates and their keys are generally recommended to be put in the <code>/etc/ssl/private</code> (for keys) and <code>/etc/ssl/certs/</code> (for certificates). It is a best practice that we should employ.</p>
<p>To recap we have just created a key and a certificate.</p>
<ul>
<li><code>/etc/ssl/private/apache-selfsigned.key</code></li>
<li><code>/etc/ssl/certs/apache-selfsigned.crt</code></li>
</ul>
<p>You can test if either file exists by, running the following command</p>
<pre tabindex="0"><code>sudo locate apache-selfsigned.key
locate apache-selfsigned.key
</code></pre><h2 id="configure-apache-to-use-tls">Configure Apache to use TLS</h2>
<p>Since we have created our self signed certificates. We will then need to tell Apache to use them. We can do so by editing our Apache .conf file. These are typically in the <code>/etc/apache2/sites-availabe</code> folder. We will start by creating a new file in the <code>/etc/apache2/sites-available/</code> folder.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo vim /etc/apache2/sites-available/my_website.conf
</span></span></code></pre></div><p>next you will want to paste in the following information. Make sure to update it accordingly to before creating this file.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>&lt;VirtualHost *:443&gt;
</span></span><span style="display:flex;"><span>   ServerName your_domain_or_ip
</span></span><span style="display:flex;"><span>   DocumentRoot /var/www/your_domain_or_ip
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   SSLEngine on
</span></span><span style="display:flex;"><span>   SSLCertificateFile /etc/ssl/certs/apache-selfsigned.crt
</span></span><span style="display:flex;"><span>   SSLCertificateKeyFile /etc/ssl/private/apache-selfsigned.key
</span></span><span style="display:flex;"><span>&lt;/VirtualHost&gt;
</span></span></code></pre></div><p>Next we will need to enable the configuration file with the <code>a2ensite</code> tool.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo a2ensite my_website.conf
</span></span><span style="display:flex;"><span>sudo systemctl reload apache2
</span></span></code></pre></div><p>Finally, your web server should be good to go with a self signed cert. Now I would recommend you visit it and ensuring that you are using the <code>https://</code> prefix. If alls well, you should get a error, saying that it cant verify the identity of the server. This is normal behavior because in fact, we gave it a self signed cert. In the future, It would be advisable to get your certificates from a CA vender.</p>
<h2 id="i-no-longer-want-any-http-requests">I no longer want any http:// requests</h2>
<p>We can redirect all <code>http://</code> to your <code>https://</code> route relatively easily. To do so you will need to edit your .conf that we created above, and add the following configuration to it:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>&lt;VirtualHost *:80&gt;
</span></span><span style="display:flex;"><span>	ServerName your_domain_or_ip
</span></span><span style="display:flex;"><span>	Redirect / https://your_domain_or_ip/
</span></span><span style="display:flex;"><span>&lt;/VirtualHost&gt;
</span></span></code></pre></div><p>I would recommend doing a backup of the conf before hand just incase you break something in the process. You never really know what may happen.</p>
<p>Now all you will need to do is bounce the service, and give it a run.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo apachectl configtest
</span></span><span style="display:flex;"><span>sudo systemctl reload apache2
</span></span></code></pre></div><p>You can test this by attempting to force your browser to visit the insecure version of the site. To do so ensure that the prefix to the websites name is <code>http://</code>.</p>

</section>


    <footer class="article-footer">
    

    </footer>


    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">Related content</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="">
    <a href="/post/2023.09.21-simple-file-parsing-takes-three-hours/">
        
        

        <div class="article-details">
            <h2 class="article-title">Simple File Parsing Takes Three Hours</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/post/2023.09.19-organizational-behaviour-examples/">
        
        

        <div class="article-details">
            <h2 class="article-title">Organizational Behaviour Examples</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/post/2023.09.08-searching-text-files-with-grep/">
        
        

        <div class="article-details">
            <h2 class="article-title">How to search Text files with grep</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/post/2023.09.07-where-am-i-on-the-network/">
        
        

        <div class="article-details">
            <h2 class="article-title">Where am i on the network?</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/post/2023.09.07-vacation/">
        
        
            <div class="article-image">
                
                    <img src="https://unorthodoxdev-bucket-public.s3.amazonaws.com/scorpion-hand.jpeg" loading="lazy" data-key="" data-hash="https://unorthodoxdev-bucket-public.s3.amazonaws.com/scorpion-hand.jpeg"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Vacation</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
        2023 Unorthodoxdev
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.17.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
