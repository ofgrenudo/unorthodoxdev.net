<!DOCTYPE html>
<html lang="en-us" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='They never go away...'>
<meta name="keywords" content="unorthodoxdev"><title>Ghost Printers</title>

<link rel='canonical' href='https://unorthodoxdev.net/post/2023.07.20-ghost-printers/'>

<link rel="stylesheet" href="/scss/style.min.abbd69b2908fdfcd5179898beaafd374514a86538d81639ddd2c58c06ae54e40.css"><meta property='og:title' content='Ghost Printers'>
<meta property='og:description' content='They never go away...'>
<meta property='og:url' content='https://unorthodoxdev.net/post/2023.07.20-ghost-printers/'>
<meta property='og:site_name' content='Unorthodoxdev'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:published_time' content='2023-07-20T16:03:40-04:00'/><meta property='article:modified_time' content='2023-07-20T16:03:40-04:00'/>
<meta name="twitter:title" content="Ghost Printers">
<meta name="twitter:description" content="They never go away...">
    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column compact"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu0e157a647bf02fa2552a62499790ea99_23064_300x0_resize_box_3.png" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">Unorthodoxdev</a></h1>
            <h2 class="site-description"></h2>
        </div>
    </header><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Home</span>
            </a>
        </li>
        
        
        <li >
            <a href='/page/about/' >
                
                
                
                    <!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Uploaded to: SVG Repo, www.svgrepo.com, Transformed by: SVG Repo Mixer Tools -->
<svg width="800px" height="800px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<g id="SVGRepo_bgCarrier" stroke-width="0"/>
<g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"/>
<g id="SVGRepo_iconCarrier"> <path d="M12 17V11" stroke="#c0c0c0" stroke-width="1.5" stroke-linecap="round"/> <circle cx="1" cy="1" r="1" transform="matrix(1 0 0 -1 11 9)" fill="#c0c0c0"/> <path d="M22 12C22 16.714 22 19.0711 20.5355 20.5355C19.0711 22 16.714 22 12 22C7.28595 22 4.92893 22 3.46447 20.5355C2 19.0711 2 16.714 2 12C2 7.28595 2 4.92893 3.46447 3.46447C4.92893 2 7.28595 2 12 2C16.714 2 19.0711 2 20.5355 3.46447C21.5093 4.43821 21.8356 5.80655 21.9449 8" stroke="#c0c0c0" stroke-width="1.5" stroke-linecap="round"/> </g>
</svg>
                
                <span>About</span>
            </a>
        </li>
        
        
        <li >
            <a href='/page/recipes/' >
                
                
                
                    <!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Uploaded to: SVG Repo, www.svgrepo.com, Transformed by: SVG Repo Mixer Tools -->
<svg fill="#c0c0c0" height="800px" width="800px" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 196.979 196.979" xml:space="preserve" stroke="#c0c0c0">
<g id="SVGRepo_bgCarrier" stroke-width="0"/>
<g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"/>
<g id="SVGRepo_iconCarrier"> <g> <path d="M43.48,0C28.1,0.003,15.588,12.517,15.588,27.896v141.188c0,15.38,12.512,27.894,27.893,27.896h131.66 c3.452,0,6.25-2.798,6.25-6.25v-21.646v-21.646V49.542V6.25c0-3.452-2.798-6.25-6.25-6.25H43.48z M43.481,12.5h125.41v37.042 v91.645H43.48c-5.687,0.001-10.978,1.716-15.392,4.649V27.896C28.088,19.408,34.994,12.501,43.481,12.5z M168.891,184.479H43.482 c-8.488-0.001-15.394-6.908-15.394-15.396c0-8.488,6.905-15.395,15.393-15.396h125.41v9.146h-98.41c-3.452,0-6.25,2.798-6.25,6.25 c0,3.452,2.798,6.25,6.25,6.25h98.41V184.479z"/> <path d="M73.496,87.7v23.664c0,3.452,2.798,6.25,6.25,6.25h37.486c3.452,0,6.25-2.798,6.25-6.25V87.701 c8.258-3.315,13.982-11.413,13.982-20.669c0-11.935-9.437-21.706-21.24-22.244c-4.161-5.506-10.644-8.791-17.734-8.791 c-7.093,0-13.575,3.285-17.735,8.791c-11.804,0.538-21.241,10.31-21.241,22.244C59.514,76.289,65.239,84.386,73.496,87.7z M81.782,57.265c0.473,0,0.954,0.035,1.433,0.105c2.686,0.397,5.313-0.986,6.512-3.418c1.661-3.364,5.02-5.455,8.765-5.455 c3.744,0,7.103,2.091,8.766,5.457c1.2,2.432,3.839,3.811,6.513,3.416c0.476-0.07,0.956-0.105,1.429-0.105 c5.386,0,9.768,4.382,9.768,9.768c0,4.905-3.663,9.069-8.52,9.685c-3.122,0.396-5.463,3.053-5.463,6.2v22.196H85.996V83.331 c0-0.007,0.001-0.015,0.001-0.021c0.207-3.293-2.182-6.18-5.455-6.593c-4.862-0.613-8.528-4.776-8.528-9.685 C72.014,61.646,76.396,57.265,81.782,57.265z"/> </g> </g>
</svg>
                
                <span>Recipes</span>
            </a>
        </li>
        
        
        <li >
            <a href='/page/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        
        
        <li >
            <a href='/page/links/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>Links</span>
            </a>
        </li>
        
        
        <li >
            <a href='/page/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        

        <div class="menu-bottom-section">
            
            
                <li id="dark-mode-toggle">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <span>Dark Mode</span>
                </li>
            
        </div>
    </ol>
</aside>

    

            <main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/system-administration/" style="background-color: #2a9d8f; color: #fff;">
                System Administration
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/post/2023.07.20-ghost-printers/">Ghost Printers</a>
        </h2>
    
        
        <h3 class="article-subtitle">
            They never go away...
        </h3>
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Jul 20, 2023</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    4 minute read
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <p>Ive recently had an encounter with a printer that creates 100s of copies of its self within the computers printer settings. Ive spent quite a bit of time tinkering with this printer and its settings. I think I’ve come to a resolution. Overall, to recap what I did; Opening up the Regedit there were 100’s of keys associated with the Xerox printer. Typically, these registry keys are created when installing the printer and the windows printui.dll handles it. But the amount of registry keys meant that windows kept recreating these keys. I dug a little bit more into the registry keys and it appears that each of these keys had the following properties assigned to them. Name “PRT-AWH-321-COLOR”, Driver “Xerox …” that was pretty much it. The rest of the fields were empty.</p>
<p>I started off looking into removing these printers via a script etc. Doing so I found the existence of a registry key we can create that would have windows remove the printers on exit. To enable this feature you would have to create a 32bit dWord key in the following location <code>&quot;HKLM:\Software\Microsoft\Windows NT\CurrentVersion\Print\Providers\Client Side Rendering Print Provider&quot;</code> with the name <code>&quot;RemovePrintersAtLogoff&quot;</code> and the value of 1.</p>
<p>After creating this key, when a user logs out it should clear out any installed printers, and apply the group policy user settings next time a user logs in. Well creating that key and then logging out seemed to work. But those xerox registry keys persisted for some reason. I grabbed one of the GUIDS from a ghost printer and ran a search for all the instances I could find it in regedit. I ran across quite a few instances and ended up writing a script.</p>
<p>We start by stopping the printer spooler, and then removing the following:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>HKLM:<span style="color:#ae81ff">\S</span>OFTWARE<span style="color:#ae81ff">\M</span>icrosoft<span style="color:#ae81ff">\W</span>indows NT<span style="color:#ae81ff">\C</span>urrentVersion<span style="color:#ae81ff">\P</span>rint<span style="color:#ae81ff">\C</span>onnections
</span></span><span style="display:flex;"><span>HKLM:<span style="color:#ae81ff">\S</span>OFTWARE<span style="color:#ae81ff">\M</span>icrosoft<span style="color:#ae81ff">\W</span>indows NT<span style="color:#ae81ff">\C</span>urrentVersion<span style="color:#ae81ff">\P</span>rint<span style="color:#ae81ff">\P</span>rinters
</span></span><span style="display:flex;"><span>HKLM:<span style="color:#ae81ff">\S</span>OFTWARE<span style="color:#ae81ff">\M</span>icrosoft<span style="color:#ae81ff">\W</span>indows NT<span style="color:#ae81ff">\C</span>urrentVersion<span style="color:#ae81ff">\P</span>rint<span style="color:#ae81ff">\P</span>roviders
</span></span><span style="display:flex;"><span>HKLM:<span style="color:#ae81ff">\S</span>OFTWARE<span style="color:#ae81ff">\M</span>icrosoft<span style="color:#ae81ff">\W</span>indows NT<span style="color:#ae81ff">\C</span>urrentVersion<span style="color:#ae81ff">\P</span>rint<span style="color:#ae81ff">\V</span><span style="color:#ae81ff">4</span> Connections
</span></span><span style="display:flex;"><span>HKLM:<span style="color:#ae81ff">\S</span>OFTWARE<span style="color:#ae81ff">\W</span>ow6432Node<span style="color:#ae81ff">\M</span>icrosoft<span style="color:#ae81ff">\W</span>indows NT<span style="color:#ae81ff">\C</span>urrentVersion<span style="color:#ae81ff">\P</span>rint<span style="color:#ae81ff">\C</span>onnections
</span></span><span style="display:flex;"><span>HKLM:<span style="color:#ae81ff">\S</span>OFTWARE<span style="color:#ae81ff">\W</span>ow6432Node<span style="color:#ae81ff">\M</span>icrosoft<span style="color:#ae81ff">\W</span>indows NT<span style="color:#ae81ff">\C</span>urrentVersion<span style="color:#ae81ff">\P</span>rint<span style="color:#ae81ff">\P</span>rinters
</span></span><span style="display:flex;"><span>HKLM:<span style="color:#ae81ff">\S</span>OFTWARE<span style="color:#ae81ff">\W</span>ow6432Node<span style="color:#ae81ff">\M</span>icrosoft<span style="color:#ae81ff">\W</span>indows NT<span style="color:#ae81ff">\C</span>urrentVersion<span style="color:#ae81ff">\P</span>rint<span style="color:#ae81ff">\P</span>roviders
</span></span><span style="display:flex;"><span>HKLM:<span style="color:#ae81ff">\S</span>OFTWARE<span style="color:#ae81ff">\W</span>ow6432Node<span style="color:#ae81ff">\M</span>icrosoft<span style="color:#ae81ff">\W</span>indows NT<span style="color:#ae81ff">\C</span>urrentVersion<span style="color:#ae81ff">\P</span>rint<span style="color:#ae81ff">\V</span><span style="color:#ae81ff">4</span> Connections
</span></span><span style="display:flex;"><span>HKCU:<span style="color:#ae81ff">\P</span>rinters
</span></span><span style="display:flex;"><span>HKCU:<span style="color:#ae81ff">\S</span>oftware<span style="color:#ae81ff">\M</span>icrosoft<span style="color:#ae81ff">\W</span>indows NT<span style="color:#ae81ff">\C</span>urrentVersion<span style="color:#ae81ff">\P</span>rinterPorts
</span></span><span style="display:flex;"><span>HKEY_USERS<span style="color:#ae81ff">\.</span>DEFAULT<span style="color:#ae81ff">\P</span>rinters
</span></span></code></pre></div><p>The following below you need a system user context to remove. You can do so by using PSExec from Windows PowerToys.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>HKLM:<span style="color:#ae81ff">\S</span>YSTEM<span style="color:#ae81ff">\C</span>urrentControlSet<span style="color:#ae81ff">\E</span>num<span style="color:#ae81ff">\S</span>WD<span style="color:#ae81ff">\P</span>RINTENUM 
</span></span><span style="display:flex;"><span>HKLM:<span style="color:#ae81ff">\S</span>YSTEM<span style="color:#ae81ff">\C</span>urrentControlSet<span style="color:#ae81ff">\C</span>ontrol<span style="color:#ae81ff">\D</span>eviceClasses<span style="color:#ae81ff">\{</span>0ecef634-6ef0-472a-8085-5ad023ecbccd<span style="color:#f92672">}</span> 
</span></span><span style="display:flex;"><span>HKLM:<span style="color:#ae81ff">\S</span>YSTEM<span style="color:#ae81ff">\C</span>ontrolSet001<span style="color:#ae81ff">\E</span>num<span style="color:#ae81ff">\S</span>WD<span style="color:#ae81ff">\P</span>RINTENUM    
</span></span><span style="display:flex;"><span>HKLM:<span style="color:#ae81ff">\S</span>YSTEM<span style="color:#ae81ff">\C</span>ontrolSet001<span style="color:#ae81ff">\C</span>ontrol<span style="color:#ae81ff">\D</span>eviceClasses<span style="color:#ae81ff">\{</span>0ecef634-6ef0-472a-8085-5ad023ecbccd<span style="color:#f92672">}</span>    
</span></span><span style="display:flex;"><span>HKLM:<span style="color:#ae81ff">\S</span>YSTEM<span style="color:#ae81ff">\C</span>ontrolSet002<span style="color:#ae81ff">\E</span>num<span style="color:#ae81ff">\S</span>WD<span style="color:#ae81ff">\P</span>RINTENUM    
</span></span><span style="display:flex;"><span>HKLM:<span style="color:#ae81ff">\S</span>YSTEM<span style="color:#ae81ff">\C</span>ontrolSet002<span style="color:#ae81ff">\C</span>ontrol<span style="color:#ae81ff">\D</span>eviceClasses<span style="color:#ae81ff">\{</span>0ecef634-6ef0-472a-8085-5ad023ecbccd<span style="color:#f92672">}</span>    
</span></span><span style="display:flex;"><span>HKLM:<span style="color:#ae81ff">\S</span>YSTEM<span style="color:#ae81ff">\C</span>urrentControlSet<span style="color:#ae81ff">\C</span>ontrol<span style="color:#ae81ff">\C</span>lass<span style="color:#ae81ff">\{</span>1ed2bbf9-11f0-4084-b21f-ad83a8e6dcdc<span style="color:#f92672">}</span> 
</span></span></code></pre></div><p>After doing so, when you open up the control panel all the printers should be grayed out. Because these printers are being added via group policy, doing a reboot, should resolve any issues we had previously. Once the computer comes back up again, all of those printers should remain grey, and anything that gets installed via group policy should then fill in with color. But shortly after, it started happening again. I kept getting notifications of the printer installing, over and over and over again.</p>
<p>With that, its confirms that it is not some residual left over install, but narrows it down to one or two things. A messed up group policy or a bad driver. Looking at the group policy I could find anything wrong, so I decided to start at the driver. I took the computer off the domain, and downloaded the PCL, General, and PS, driver for the printer.</p>
<p>Once the computers off the domain, I remove all printers. And repeat the above steps. After doing so I started with the identical driver installed, the General driver. I setup the printer and as soon as the install finishes. I immediately get the same issue again.</p>
<p>Its no longer a group policy issue, its now a driver issue. Uninstall all the printers again and start from step one. Once I get to installing the printer I use the PCL driver. I had similar issues. Finally the Post Script (PS) driver ended up working for me and resolved in no issues.</p>
<p>Either way, cleaning up the ghost printers is a pain in my ass, and is nothing but manual labor. I ended up reimaging the comptuers after fixing the driver on the print server and going from there.</p>
<p>Since then its seemed to have been fixed.</p>
<h2 id="scripts">Scripts</h2>
<p>part-one.ps1</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Powershell" data-lang="Powershell"><span style="display:flex;"><span>New-ItemProperty -Path <span style="color:#e6db74">&#34;HKLM:\Software\Microsoft\Windows NT\CurrentVersion\Print\Providers\Client Side Rendering Print Provider&#34;</span> -Name <span style="color:#e6db74">&#34;RemovePrintersAtLogoff&#34;</span> -Value <span style="color:#ae81ff">1</span> -Force
</span></span><span style="display:flex;"><span>Restart-Computer -Force
</span></span></code></pre></div><p>part-two.ps1</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Powershell" data-lang="Powershell"><span style="display:flex;"><span>Stop-Service spooler -Force
</span></span><span style="display:flex;"><span>Remove-Item -Path <span style="color:#e6db74">&#34;HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Print\Connections&#34;</span> -Recurse
</span></span><span style="display:flex;"><span>Remove-Item -Path <span style="color:#e6db74">&#34;HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Print\Printers&#34;</span> -Recurse
</span></span><span style="display:flex;"><span>Remove-Item -Path <span style="color:#e6db74">&#34;HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Print\Providers&#34;</span> -Recurse
</span></span><span style="display:flex;"><span>Remove-Item -Path <span style="color:#e6db74">&#34;HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Print\V4 Connections&#34;</span> -Recurse
</span></span><span style="display:flex;"><span>Remove-Item -Path <span style="color:#e6db74">&#34;HKLM:\SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Print\Connections&#34;</span> -Recurse
</span></span><span style="display:flex;"><span>Remove-Item -Path <span style="color:#e6db74">&#34;HKLM:\SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Print\Printers&#34;</span> -Recurse
</span></span><span style="display:flex;"><span>Remove-Item -Path <span style="color:#e6db74">&#34;HKLM:\SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Print\Providers&#34;</span> -Recurse
</span></span><span style="display:flex;"><span>Remove-Item -Path <span style="color:#e6db74">&#34;HKLM:\SOFTWARE\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Print\V4 Connections&#34;</span> -Recurse
</span></span><span style="display:flex;"><span>Remove-Item -Path <span style="color:#e6db74">&#34;HKCU:\Printers&#34;</span> -Recurse
</span></span><span style="display:flex;"><span>Remove-Item -Path <span style="color:#e6db74">&#34;HKCU:\Software\Microsoft\Windows NT\CurrentVersion\PrinterPorts&#34;</span> -Recurse
</span></span><span style="display:flex;"><span>Remove-Item -Path <span style="color:#e6db74">&#34;Registry::HKEY_USERS\.DEFAULT\Printers&#34;</span> -Recurse
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>.\PsExec.exe /accepteula
</span></span><span style="display:flex;"><span>.\PsExec.exe powershell Remove-Item -Path <span style="color:#e6db74">&#34;HKLM:\SYSTEM\CurrentControlSet\Enum\SWD\PRINTENUM&#34;</span> -Recurse
</span></span><span style="display:flex;"><span>.\PsExec.exe powershell Remove-Item -Path <span style="color:#e6db74">&#34;HKLM:\SYSTEM\CurrentControlSet\Control\DeviceClasses\{0ecef634-6ef0-472a-8085-5ad023ecbccd}&#34;</span> -Recurse
</span></span><span style="display:flex;"><span>.\PsExec.exe powershell Remove-Item -Path <span style="color:#e6db74">&#34;HKLM:\SYSTEM\ControlSet001\Enum\SWD\PRINTENUM&#34;</span> -Recurse -ErrorAction SilentlyContinue
</span></span><span style="display:flex;"><span>.\PsExec.exe powershell Remove-Item -Path <span style="color:#e6db74">&#34;HKLM:\SYSTEM\ControlSet001\Control\DeviceClasses\{0ecef634-6ef0-472a-8085-5ad023ecbccd}&#34;</span> -Recurse -ErrorAction SilentlyContinue
</span></span><span style="display:flex;"><span>.\PsExec.exe powershell Remove-Item -Path <span style="color:#e6db74">&#34;HKLM:\SYSTEM\ControlSet002\Enum\SWD\PRINTENUM&#34;</span> -Recurse -ErrorAction SilentlyContinue
</span></span><span style="display:flex;"><span>.\PsExec.exe powershell Remove-Item -Path <span style="color:#e6db74">&#34;HKLM:\SYSTEM\ControlSet002\Control\DeviceClasses\{0ecef634-6ef0-472a-8085-5ad023ecbccd}&#34;</span> -Recurse -ErrorAction SilentlyContinue
</span></span><span style="display:flex;"><span>.\PsExec.exe powershell Remove-Item -Path <span style="color:#e6db74">&#34;HKLM:\SYSTEM\CurrentControlSet\Control\Class\{1ed2bbf9-11f0-4084-b21f-ad83a8e6dcdc}&#34;</span> -Recurse 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Restart-Computer -Force
</span></span></code></pre></div>
</section>


    <footer class="article-footer">
    

    </footer>


    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">Related content</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="has-image">
    <a href="/post/2023.07.19-mecm-api/">
        
        
            <div class="article-image">
                
                    <img src="https://images.unsplash.com/photo-1569653402334-2e98fbaa80ee" loading="lazy" data-key="" data-hash="https://images.unsplash.com/photo-1569653402334-2e98fbaa80ee"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">MECM API</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/post/2023.07.19-tattoo/">
        
        

        <div class="article-details">
            <h2 class="article-title">Tattoo</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/post/2023.07.19-ci-pipelines-with-rust/">
        
        
            <div class="article-image">
                
                    <img src="https://images.unsplash.com/photo-1609213244695-7d6902be89da" loading="lazy" data-key="" data-hash="https://images.unsplash.com/photo-1609213244695-7d6902be89da"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Ci Pipelines With Rust</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/post/2023.07.19-ublock-origin-and-more/">
        
        
            <div class="article-image">
                
                    <img src="https://images.unsplash.com/photo-1496442226666-8d4d0e62e6e9" loading="lazy" data-key="" data-hash="https://images.unsplash.com/photo-1496442226666-8d4d0e62e6e9"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Ublock Origin and More</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/post/2023.07.19-digital-gardens/">
        
        
            <div class="article-image">
                
                    <img src="https://images.unsplash.com/photo-1550948390-6eb7fa773072" loading="lazy" data-key="" data-hash="https://images.unsplash.com/photo-1550948390-6eb7fa773072"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Digital Gardens</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
        2024 Unorthodoxdev
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.21.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
